{% extends "base.html" %}

{% block title %}Twistle - Statistics{% endblock %}

{% block content %}
<div class="flex flex-col items-center w-full max-w-md px-4">
    <div class="flex justify-between items-center w-full py-4">
        <a href="{{ url_for('index') }}" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-gray-900 dark:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </a>
        <h1 class="text-2xl font-extrabold tracking-tight text-gray-900 dark:text-white">Statistics</h1>
        <div class="w-6"></div>
    </div>
    
    <div class="bg-white rounded-lg p-6 w-full shadow-md dark:bg-gray-800 dark:text-white">
        <div class="grid grid-cols-4 gap-4 mb-6">
            <div class="flex flex-col items-center">
                <p class="text-2xl font-bold">{{ stats.games_played }}</p>
                <p class="text-xs">Games</p>
            </div>
            <div class="flex flex-col items-center">
                <p class="text-2xl font-bold">{{ stats.avg_score }}</p>
                <p class="text-xs">Avg Score</p>
            </div>
            <div class="flex flex-col items-center">
                <p class="text-2xl font-bold">{{ stats.best_score }}</p>
                <p class="text-xs">Best</p>
            </div>
            <div class="flex flex-col items-center">
                <p class="text-2xl font-bold">{{ stats.streak }}</p>
                <p class="text-xs">Streak</p>
            </div>
        </div>
        
        <div class="mb-6">
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Total Anagrams Found</p>
            <p class="text-2xl font-bold">{{ stats.total_anagrams }}</p>
        </div>
        
        <p class="font-bold mb-2">Your Best Performances</p>
        {% for performance in stats.best_performances %}
        <div class="bg-gray-100 rounded-lg p-3 mb-4 dark:bg-gray-700">
            <div class="flex justify-between items-center mb-2">
                <p class="font-medium">{{ performance.date }}</p>
                <p class="font-bold">{{ performance.score }} pts</p>
            </div>
            <p class="text-sm">Words solved: {{ performance.words_solved }}/10</p>
            <p class="text-sm">Theme: {{ performance.theme }}</p>
            {% if performance.anagrams > 0 %}
            <p class="text-sm text-indigo-600 dark:text-indigo-400">Anagrams found: {{ performance.anagrams }}</p>
            {% endif %}
        </div>
        {% endfor %}
        
        <div class="mt-8 border-t pt-4">
            <p class="font-bold mb-4 text-center">Keep playing to improve your stats!</p>
            <button id="shareStatsButton" class="w-full py-2 bg-green-500 text-white rounded-full font-bold">
                Share All-Time Stats
            </button>
        </div>
    </div>
</div>

<script>
document.getElementById('shareStatsButton').addEventListener('click', function() {
    const statsText = `Twistle Statistics
Games Played: {{ stats.games_played }}
Average Score: {{ stats.avg_score }}
Best Score: {{ stats.best_score }}

Play Twistle daily at: {{ request.url_root }}`;

    if (navigator.share) {
        navigator.share({
            title: 'My Twistle Statistics',
            text: statsText
        });
    } else {
        navigator.clipboard.writeText(statsText)
            .then(() => {
                alert('Statistics copied to clipboard!');
            });
    }
});
</script>
{% endblock %}